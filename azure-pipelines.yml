trigger:
- main

variables:
  SKIP_INTEGRATION_TESTS: 'true'

jobs:
- job: tests_macos
  displayName: 'Tests, macOS'
  strategy:
    maxParallel: '10'
    matrix:
      '14, Xcode 15.4':
        image: 'macOS-14'
        xcode: '15.4'
      # '14, Xcode 16.3': Runs on Buildkite.
      '15, Xcode 16.4':
        image: 'macOS-15'
        xcode: '16.4'
  pool:
    vmImage: $(image)
  variables:
    DEVELOPER_DIR: /Applications/Xcode_$(xcode).app
  steps:
    - script: make spm_test
      displayName: Run tests
